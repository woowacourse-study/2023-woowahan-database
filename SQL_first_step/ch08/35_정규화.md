# 목차

1. [정규화](#1-정규화) <br/>
2. [제1 정규형](#2-제1-정규형) <br/>
3. [제2 정규형](#3-제2-정규형) <br/>
4. [제3 정규형](#4-제3-정규형) <br/>
5. [정규화의 목적](#5-정규화의-목적) <br/>

<br/>

# 35강 - 정규화

## 1. 정규화

- **테이블을 올바른 형태로 변경하고 분할하는 것**을 **'정규화'** 라고 합니다.

정규화 과정을 진행할 테이블을 먼저 만들어봅시다.

| 주문번호 | 날짜 | 성명   | 연락처        | 주문상품                  |
| -------- | ---- | ------ | ------------- | ------------------------- |
| 1        | 1/1  | 박준용 | 010-XXXX-XXXX | 0001 OO 1개, 0002 XX 10개 |
| 2        | 2/1  | 김재진 | 010-XXXX-XXXX | 0001 OO 2개, 0002 XX 3개  |

주문상품에 상품코드(0001), 상품 이름(OO), 상품개수(1개) 가 전부 들어있는 모습입니다.

<br/>

## 2. 제1 정규형

- **반복되는 데이터를 가로(열 방향)가 아닌 세로(행 방향)로 늘리는 것이 제1 정규화의 제1단계이다.**
- **제1 정규화에서는 테이블 분할과 기본키 지정이 이루어진다.**

이 2가지를 상기하면서 위의 테이블의 제1 정규화 과정을 살펴봅시다.

<br/>

| 주문번호 | 날짜 | 성명   | 연락처        | 상품코드 | 상품명 | 개수 |
| -------- | ---- | ------ | ------------- | -------- | ------ | ---- |
| 1        | 1/1  | 박준용 | 010-XXXX-XXXX | 0001     | OO     | 1    |
| 1        | 1/1  | 박준용 | 010-XXXX-XXXX | 0002     | XX     | 10   |
| 2        | 2/1  | 김재진 | 010-XXXX-XXXX | 0001     | OO     | 2    |
| 2        | 2/1  | 김재진 | 010-XXXX-XXXX | 0002     | XX     | 3    |

이런식으로 제1 정규화를 통해 좀 더 체계적인 테이블로 발전시킵니다. 여기서 한 번 더 중복되는 부분(주문번호, 날짜, 성명, 연락처)을 없애도록 정규화를 진행해봅시다. 저 중복되는 부분을 따로 테이블로 분리해보겠습니다.

여기서 드는 아벨의 개인적인 생각은 자바에서 클래스 및 메서드로 분리하는 리팩토링 과정과 굉장히 닮았다고 생각합니다.

**(주문 테이블)**

| 주문번호 | 날짜 | 성명   | 연락처        |
| -------- | ---- | ------ | ------------- |
| 1        | 1/1  | 박준용 | 010-XXXX-XXXX |
| 2        | 2/1  | 김재진 | 010-XXXX-XXXX |

**(주문상품 테이블)**

| 주문번호 | 상품코드 | 상품명 | 개수 |
| -------- | -------- | ------ | ---- |
| 1        | 0001     | OO     | 1    |
| 1        | 0002     | XX     | 10   |
| 2        | 0001     | OO     | 2    |
| 2        | 0002     | XX     | 3    |

이렇게 총 2테이블로 나뉘어지며 서로 주문번호로 연계가 됩니다. 또한 주문 테이블의 주문번호는 이제 유일해졌기 때문에 기본키로 지정할 수 있으며, 주문상품 테이블에선 주문번호와 상품코드를 같이 묶어서 기본키로 지정할 수 있게 되었습니다.

<br/>

## 3. 제2 정규형

- **제2 정규화에서는 데이터가 중복하는 부분을 찾아내어 테이블로 분할해나갑니다.**
- **방식은 기본키에 의해 특정되는 열과 그렇지 않은 열로 나누는 것으로 진행됩니다.**

예시를 위해 위의 주문상품 테이블을 다시 가져와봅시다.

**(주문상품 테이블)**

| 주문번호 | 상품코드 | 상품명 | 개수 |
| -------- | -------- | ------ | ---- |
| 1        | 0001     | OO     | 1    |
| 1        | 0002     | XX     | 10   |
| 2        | 0001     | OO     | 2    |
| 2        | 0002     | XX     | 3    |

<br/>

여기서 주의깊게 봐야할 부분은, 주문번호와 상품코드는 기본키이지만 상품명은 그렇지 못하다는 것입니다. 또한 상품명은 상품코드 하나만으로 특정지을 수 있는 컬럼입니다. 이것을 토대로 테이블을 한 번 더 분할해봅시다.

**(주문상품 테이블)**

| 주문번호 | 상품코드 | 개수 |
| -------- | -------- | ---- |
| 1        | 0001     | 1    |
| 1        | 0002     | 10   |
| 2        | 0001     | 2    |
| 2        | 0002     | 3    |

**(상품 테이블)**

| 상품코드 | 상품명 |
| -------- | ------ |
| 0001     | OO     |
| 0002     | XX     |

이처럼 분리가 이루어지면, 상품 테이블에서 상품코드를 기본키로 지정할 수 있게 됩니다. 즉, **제2 정규화는 부분 함수종속성을 찾아내서 테이블을 분할하는 것**입니다. **함수 종속성이란, 키 값을 이용해 데이터를 특정지을 수 있는 것**입니다.

<br/>

## 4. 제3 정규형

- **제3 정규화 또한 중복하는 부분을 찾아내어 테이블을 분할하는 것입니다.**

- **제2 정규화에선 기본키에 중복이 없는지 조사했고, 제3 정규화에선 기본키 이외의 부분에서 중복이 없는지 조사합니다.**

**(주문 테이블)**

| 주문번호 | 날짜 | 성명   | 연락처        |
| -------- | ---- | ------ | ------------- |
| 1        | 1/1  | 박준용 | 010-XXXX-XXXX |
| 2        | 2/1  | 김재진 | 016-XXXX-XXXX |
| 3        | 2/5  | 박준용 | 010-XXXX-XXXX |

여기서 기본키 외의 컬럼 중 중복되는 컬럼(성명, 연락처)을 테이블로 따로 분리해봅시다.

<br/>

**(주문 테이블)**

| 주문번호 | 날짜 | 고객번호 |
| -------- | ---- | -------- |
| 1        | 1/1  | 1        |
| 2        | 2/1  | 2        |
| 3        | 2/5  | 1        |

**(고객 테이블)**

| 고객번호 | 성명   | 연락처        |
| -------- | ------ | ------------- |
| 1        | 박준용 | 010-XXXX-XXXX |
| 2        | 김재진 | 016-XXXX-XXXX |

이처럼 중복되는 기본키 외의 컬럼을 따로 분리할 수 있습니다. 여기선 고객번호라는 컬럼을 새로 만들어서 연계시킨 모습입니다. 고객 테이블에서 성명을 기본키로 하지 않은 이유는, 동명이인일 경우 때문입니다. 실제론 제5 정규형까지 있지만, 대부분의 시스템에선 제3 정규형까지의 정규화를 채택합니다.

<br/>

## 5. 정규화의 목적

- **정규화로 데이터 구조를 개선하는것은 하나의 데이터가 한 곳에 저장되도록 하기 위함입니다.**

하나의 데이터가 반드시 한 곳에만 저장되어 있다면, 데이터를 변경하더라도 한 곳만 변경하는 것으로 끝낼 수 있습니다. 개인적으로 자바에서의 높은 응집도를 추구하는 것과 같다는 생각이 들었습니다.

또한 정규화를 하지 않는다면, 인덱스가 지정된 열의 데이터가 변경되는 경우엔 인덱스도 재구축해야 합니다. 따라서, 정규화를 통해 테이블에 대한 인덱스의 재구축을 억제할 수 있습니다.
