# 목차

1. [UPDATE로 데이터 갱신하기](#1-update로-데이터-갱신하기)
2. [UPDATE로 갱신할 경우 주의사항](#2-update로-갱신할-경우-주의사항)
3. [복수열 갱신](#3-복수열-갱신)
4. [NULL로 갱신하기](#4-null로-갱신하기)

# 18강 - 데이터 갱신하기 UPDATE

## 1. UPDATE로 데이터 갱신하기

```SQL
UPDATE 테이블명 SET 열명 = 값 WHERE 조건식;
```

- WHERE 구에 일치하는 모든 행을 갱신한다.
- WHERE 구에 조건을 지정하지 않으면 테이블의 모든 행이 갱신된다.
- SET 구를 사용하여 갱신할 열과 값을 지정한다.
- 값은 자료형에 맞는 값을 지정해야 한다.

실행 예시 )

현재 sample41의 테이블은 다음과 같다.
| no | a | b |
| -- | --- | ----|
| 1 | ABC | 2023-02-20 |
| 2 | XYZ | NULL|

```SQL
UPDATE sample41 SET b = '2023-02-22' WHERE no = 2;
```

결과)
| no | a | b |
| -- | --- | ----|
| 1 | ABC | 2023-02-20 |
| 2 | XYZ | 2023-02-22|

## 2. UPDATE로 갱신할 경우 주의사항

위의 sample41 테이블에 다음과 같은 명령을 실행하면 어떻게 될까?

```SQL
UPDATE sample41 SET no = no + 1;
```

결과)
| no | a | b |
| -- | --- | ----|
| 2 | ABC | 2023-02-20 |
| 3 | XYZ | 2023-02-22|

no열이 1씩 더해졌다. <br />
이처럼 갱신할 값을 열이 포함된 식으로도 표기할 수 있다!

## 3. 복수열 갱신

```SQL
UPDATE 테이블명 SET 열명1 = 값1, 열명2 = 값2, ... WHERE 조건식;
```

- 복수열을 따로 나누어 UPDATE 명령을 실행하는 것보다 하나로 묶어서 실행하는 것이 더 효율적이다.

### SET 구의 실행 순서

SET 구는 어떤 순서로 갱신 처리하는지 알아야한다. <br />
다음과 같은 2개의 명령이 있을 때 어떤 순서로 처리되는지 알아보자. <br />

```SQL
UPDATE sample41 SET no = no + 1, a = no;
UPDATE sample41 SET a = no, no = no + 1;
```

데이터베이스 제품에 따라 처리 방식이 다르다.

현재 sample41 테이블은 다음과 같다.
| no | a | b |
| -- | --- | ----|
| 2 | ABC | 2023-02-20 |
| 3 | XYZ | 2023-02-22|

### MySQL의 경우

1. 첫 번째 명령을 실행하면 no 열과 a 열의 값이 서로 같아진다.

   | no  | a   | b          |
   | --- | --- | ---------- |
   | 3   | 3   | 2023-02-20 |
   | 4   | 4   | 2023-02-22 |

- no 열의 값에 1을 더하여 no 열에 저장한 뒤, 그 값이 다시 a 열에 대입되기 때문이다.

2. 두 번째 명령을 실행하면 a 열의 값은 'no - 1' 한 값이 된다.

   | no  | a   | b          |
   | --- | --- | ---------- |
   | 4   | 3   | 2023-02-20 |
   | 5   | 4   | 2023-02-22 |

- no 열의 값을 a 열에 대입한 후, no 열의 값을 +1 하기 때문이다.

💡 **MySQL은 SET 구에 기술된 순서로 갱신 처리**가 일어나므로, 처리 순서를 고려해야 한다.

### Oracle의 경우

테이블은 MySQL 실행하기 이전과 동일한 상태라고 가정한다.

1. 첫 번째 명령을 실행하면 a 열의 값은 'no - 1' 한 값이 된다.

   | no  | a   | b          |
   | --- | --- | ---------- |
   | 3   | 2   | 2023-02-20 |
   | 4   | 3   | 2023-02-22 |

2. 두 번째 명령을 실행하면 첫 번째 명령과 동일하게 a 열의 값은 'no - 1' 한 값이 된다.

   | no  | a   | b          |
   | --- | --- | ---------- |
   | 4   | 3   | 2023-02-20 |
   | 5   | 4   | 2023-02-22 |

💡 Oracle에서는 SET 구에 기술한 식의 순서가 처리에 영향을 주지 않는다.
갱신식의 오른쪽에 위치한 no 열의 값이 항상 갱신 이전의 값을 반환하기 때문이다.

## 4. NULL로 갱신하기

```SQL
UPDATE sample41 SET a = NULL;
```

- 셀 값을 NULL로 갱신할 수 있다.
- 이를 보통 'NULL 초기화'라고 부르기도 한다.
- 다만 NOT NULL 제약이 설정되어 있는 열은 NULL이 허용되지 않는다.
